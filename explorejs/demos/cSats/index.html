<!DOCTYPE HTML>
<html>
    <head>
        <title>Space Trash</title>
        <link rel="stylesheet" type="text/css" href="styles/styles.css">
        <script src="http://yui.yahooapis.com/3.18.1/build/yui/yui-min.js"></script>
        <!--<script src="../../lib/three.min.js"></script>-->
        <script src="scripts/three.min.js"></script>
        <script src="../../lib/explore.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        
    </head>
    <body class="yui3-skin-sam">
      <div class="modal">
        <span class="btn-close">x</span>
        <p>Space travel has produced enormous amounts of space trash. The trash consists of defunct satellites,
          spent fuselages, and random debris that breaks away from ships. This site tracks some of that trash in real time.
          <br>
          <br>
          Red dots represent areas where two pieces of debris will fly past each other at a close range, risking collision. In the lower left, you can fast forward to see where potential collisions may happen in the future.
        </p>
      </div>
      
        <aside id="controls">
          <img src="Arrows.png" class="arrows">
          <div id="demo"></div>     
          <h4 class="time">Time Dial: 1 Spin = 1 
            <select id="timeSelector">
                  <option value="10" selected="selected">Minute</option>
                  <option value="600">Hour</option>
                  <option value="14400">Day</option>
                  <option value="100800">Week</option>
            </select>
          </h4>
        <div id="curDate">Current Date and Time at GMT: </div>
        </aside>
    </body>
    <script>
      $('.btn-close').on('click', function() {
        $('.modal').hide();
      });
    </script>
    
    <script language="javascript" src="scripts/OrbitControls.js"></script>
    <script id="fragmentShader" type="x-shader/x-fragment">

      uniform sampler2D dayTexture;
      uniform sampler2D nightTexture;
      uniform sampler2D normalTexture;
      uniform sampler2D cloudTexture;
      uniform float texOffset;

      uniform vec3 sunDirection;

      varying vec2 vUv;
      varying vec3 vNormal;

      void main( void ) {

      		vec3 bumpDir = vec3(0.0,-0.2,1.0);
                      vec3 dayColor = texture2D( dayTexture, vUv ).rgb;
                      vec3 nightColor = texture2D( nightTexture, vUv ).rgb;
                      vec3 cloudColor = texture2D(cloudTexture, vUv+vec2(texOffset,0.0)).rgb; 
      		//RGB of our normal map
      		vec3 NormalMap = texture2D(normalTexture, vUv).rgb;

      		 //normalize our vectors
      		vec3 N = normalize(NormalMap * 2.0 - 1.0);
      		vec3 L = normalize(bumpDir * 2.0 - 1.0);
      		float Diffuse = (dot(N, L)-0.5)*.25;

      		// compute cosine sun to normal so -1 is away from sun and +1 is toward sun.
          float cosineAngleSunToNormal = dot(normalize(vNormal), sunDirection);

          // sharpen the edge beween the transition
          cosineAngleSunToNormal = clamp( cosineAngleSunToNormal * 10.0, -1.0, 1.0);

          // convert to 0 to 1 for mixing
          float mixAmount = cosineAngleSunToNormal*0.5 + 0.5;

          // Select day or night texture based on mix.
          vec3 color = mix( (nightColor+(cloudColor*.2)), (dayColor+cloudColor), mixAmount )+Diffuse;
          //the calculation which brings it all together
          gl_FragColor = vec4( color, 1.0 );
      }
    </script>

    <script id="vertexShader" type="x-shader/x-vertex">

      varying vec2 vUv;
      varying vec3 vNormal;

      void main()
      {
        vUv = uv;
        vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
        //vNormal = normalMatrix * normal;
        vNormal = normal;
        gl_Position = projectionMatrix * mvPosition;
        //gl_Position = mvPosition;
      }

    </script>
    <script language="javascript" src="script.js"></script>
</html>
